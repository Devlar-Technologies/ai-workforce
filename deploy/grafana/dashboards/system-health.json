{
  "dashboard": {
    "id": null,
    "title": "Devlar AI Workforce - System Health",
    "tags": ["devlar", "workforce", "health", "monitoring"],
    "timezone": "browser",
    "panels": [
      {
        "id": 1,
        "title": "System Uptime",
        "type": "stat",
        "targets": [
          {
            "expr": "up{job=\"devlar-workforce\"}",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "mappings": [
              {
                "options": {
                  "0": {"color": "red", "index": 0, "text": "DOWN"},
                  "1": {"color": "green", "index": 1, "text": "UP"}
                },
                "type": "value"
              }
            ],
            "thresholds": {
              "steps": [
                {"color": "red", "value": null},
                {"color": "green", "value": 1}
              ]
            }
          }
        },
        "gridPos": {"h": 4, "w": 6, "x": 0, "y": 0}
      },
      {
        "id": 2,
        "title": "Telegram Bot Status",
        "type": "stat",
        "targets": [
          {
            "expr": "up{job=\"telegram-bot\"}",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "mappings": [
              {
                "options": {
                  "0": {"color": "red", "index": 0, "text": "DOWN"},
                  "1": {"color": "green", "index": 1, "text": "UP"}
                },
                "type": "value"
              }
            ]
          }
        },
        "gridPos": {"h": 4, "w": 6, "x": 6, "y": 0}
      },
      {
        "id": 3,
        "title": "Active Executions",
        "type": "stat",
        "targets": [
          {
            "expr": "workforce_active_executions",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "short",
            "thresholds": {
              "steps": [
                {"color": "green", "value": null},
                {"color": "yellow", "value": 10},
                {"color": "red", "value": 50}
              ]
            }
          }
        },
        "gridPos": {"h": 4, "w": 6, "x": 12, "y": 0}
      },
      {
        "id": 4,
        "title": "Memory Usage",
        "type": "stat",
        "targets": [
          {
            "expr": "workforce_memory_usage_bytes",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "bytes",
            "thresholds": {
              "steps": [
                {"color": "green", "value": null},
                {"color": "yellow", "value": 1073741824},
                {"color": "red", "value": 2147483648}
              ]
            }
          }
        },
        "gridPos": {"h": 4, "w": 6, "x": 18, "y": 0}
      },
      {
        "id": 5,
        "title": "External API Health Status",
        "type": "table",
        "targets": [
          {
            "expr": "workforce_external_api_health",
            "format": "table",
            "instant": true,
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "custom": {
              "displayMode": "color-background"
            },
            "mappings": [
              {
                "options": {
                  "0": {"color": "red", "index": 0, "text": "DOWN"},
                  "1": {"color": "green", "index": 1, "text": "HEALTHY"}
                },
                "type": "value"
              }
            ]
          },
          "overrides": [
            {
              "matcher": {"id": "byName", "options": "service"},
              "properties": [{"id": "custom.width", "value": 200}]
            }
          ]
        },
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 4}
      },
      {
        "id": 6,
        "title": "Alert Summary",
        "type": "table",
        "targets": [
          {
            "expr": "ALERTS{alertstate=\"firing\"}",
            "format": "table",
            "instant": true,
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "custom": {
              "displayMode": "color-background",
              "filterable": true
            }
          },
          "overrides": [
            {
              "matcher": {"id": "byName", "options": "severity"},
              "properties": [
                {
                  "id": "mappings",
                  "value": [
                    {
                      "options": {
                        "critical": {"color": "red", "index": 0},
                        "warning": {"color": "yellow", "index": 1}
                      },
                      "type": "value"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 4}
      },
      {
        "id": 7,
        "title": "Error Rate by Service",
        "type": "timeseries",
        "targets": [
          {
            "expr": "rate(workforce_executions_failed_total[5m])",
            "legendFormat": "{{pod_name}} - {{error_type}}",
            "refId": "A"
          },
          {
            "expr": "rate(telegram_bot_errors_total[5m])",
            "legendFormat": "Telegram - {{error_type}}",
            "refId": "B"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "errps",
            "color": {"mode": "palette-classic"}
          }
        },
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 12}
      },
      {
        "id": 8,
        "title": "System Resource Usage",
        "type": "timeseries",
        "targets": [
          {
            "expr": "(1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100",
            "legendFormat": "Memory Usage %",
            "refId": "A"
          },
          {
            "expr": "100 - (avg(rate(node_cpu_seconds_total{mode=\"idle\"}[5m])) * 100)",
            "legendFormat": "CPU Usage %",
            "refId": "B"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "percent",
            "color": {"mode": "palette-classic"}
          }
        },
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 12}
      },
      {
        "id": 9,
        "title": "Telegram Bot Metrics",
        "type": "timeseries",
        "targets": [
          {
            "expr": "rate(telegram_bot_messages_total[5m])",
            "legendFormat": "{{message_type}} - {{status}}",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "msgps",
            "color": {"mode": "palette-classic"}
          }
        },
        "gridPos": {"h": 8, "w": 24, "x": 0, "y": 20}
      }
    ],
    "time": {
      "from": "now-1h",
      "to": "now"
    },
    "refresh": "30s",
    "annotations": {
      "list": [
        {
          "builtIn": 1,
          "datasource": "Prometheus",
          "enable": true,
          "hide": true,
          "iconColor": "rgba(0, 211, 255, 1)",
          "name": "Annotations & Alerts",
          "type": "dashboard"
        }
      ]
    }
  }
}